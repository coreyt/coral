---
name: coral
description: Generate Coral diagrams from natural language descriptions of system architectures
---

# /coral

Generate Coral diagrams from natural language descriptions.

## Usage

```
/coral <description>
```

## Behavior

When invoked:

1. **Parse the description** to identify:
   - Entities (services, databases, external APIs, actors)
   - Relationships (connections, data flows, dependencies)
   - Hierarchy (groups, modules, nesting)

2. **Infer types** from keywords:
   | Keywords | Type |
   |----------|------|
   | service, microservice, api, server, backend, frontend | `service` |
   | database, db, postgres, mysql, mongo, store | `database` |
   | cache, redis, memcached | `database` |
   | external, third-party, stripe, aws | `external_api` |
   | user, client, customer, admin | `actor` |
   | module, component, handler | `module` |
   | group, cluster, system, tier | `group` |

3. **Infer relationships** from phrases:
   | Phrases | Relation |
   |---------|----------|
   | connects to, calls, requests | `http_request` |
   | stores in, reads from, writes to | `data_flow` |
   | depends on, uses, requires | `dependency` |
   | publishes, emits, triggers | `event` |

4. **Generate IDs** from labels (snake_case, unique)

5. **Output Coral DSL** with node declarations, edge declarations, and comments

## Output Format

```coral
// Generated by /coral
// Description: <original description>

<node declarations>

<edge declarations>
```

## Examples

### Simple Architecture
```
/coral a web app with API and database
```
Output:
```coral
service "Web App"
service "API"
database "Database"

web_app -> api [http_request]
api -> database [data_flow]
```

### Microservices
```
/coral e-commerce with React frontend, API gateway, auth/product/order services, and PostgreSQL
```
Output:
```coral
service "React Frontend"
service "API Gateway"
service "Auth Service"
service "Product Service"
service "Order Service"
database "PostgreSQL"

react_frontend -> api_gateway [http_request]
api_gateway -> auth_service [http_request]
api_gateway -> product_service [http_request]
api_gateway -> order_service [http_request]
auth_service -> postgresql [data_flow]
product_service -> postgresql [data_flow]
order_service -> postgresql [data_flow]
```

### With Hierarchy
```
/coral payment service with validation, fraud detection, and stripe integration modules
```
Output:
```coral
service "Payment Service" {
  module "Validation"
  module "Fraud Detection"
  module "Stripe Integration"
}

validation -> fraud_detection
fraud_detection -> stripe_integration
```

## Iterative Refinement

The skill supports follow-up modifications. After generating a diagram, you can request changes like "add a cache" or "add Redis for sessions".

## Notes

- Default node type is `service` when unclear
- Default relation is `dependency` when unclear
- Preserves user's terminology in labels
- IDs are auto-generated from labels
